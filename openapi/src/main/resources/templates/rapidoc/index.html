<!doctype html>
<!-- Important: must specify, else rendering will be effected -->
<html>
    <head>
        <title>{{title}}</title>
        <!-- Important: The Custom element uses utf8 characters -->
        <meta charset='utf-8' />
        <meta name='viewport' content='width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes' />
        <script src='https://unpkg.com/rapidoc{{rapidoc.version}}/dist/rapidoc-min.js'></script>
    </head>
    <body>
        <rapi-doc id='rapidoc' show-header='false' theme='{{rapidoc.theme}}' layout='{{rapidoc.layout}}'></rapi-doc>
        <script>
            var d = decodeURIComponent,
                contextPath = d(document.cookie.replace(/(?:(?:^|.*;\s*)contextPath\s*\=\s*([^;]*).*$)|^.*$/, "$1")),
                rapidoc = document.getElementById('rapidoc');
            if (contextPath === '') {
                const params = (function() {
                  var query = {},
                      a = window.location.search.substring(1).split('&'), pair;
                  for (var i = a.length - 1; i >= 0; i--) {
                      pair = a[i].split('=');
                      query[d(pair[0])] = d(pair[1] || '');
                  }
                  return query;
                })();
                contextPath = (params.contextPath && params.contextPath !== '' ? params.contextPath : '');
            }
            rapidoc.setAttribute('spec-url', contextPath + '{{specURL}}');
            if (contextPath !== '') {
                rapidoc.setAttribute('server-url', window.location.origin + contextPath);
                rapidoc.selectedServer = { 'url': window.location.origin + contextPath, 'computedUrl': window.location.origin + contextPath };
                setTimeout(function() {
                    if (rapidoc.resolvedSpec) {
                        rapidoc.resolvedSpec.servers = [];
                        rapidoc.requestUpdate();
                    } else {
                        setTimeout(this, 200);
                    }
                }, 200);
            }
        </script>
    </body>
</html>
